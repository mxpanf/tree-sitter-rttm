# RTTM: A Detailed Specification

## 1. Introduction

RTTM stands for **Rich Transcription Time Marked**. It is an open, plain-text specification format originally developed by the **National Institute of Standards and Technology (NIST)**.

Its primary purpose is to store time-marked annotations of audio or video data, created either by humans or by automated systems. It is most famously used in NIST's "Rich Transcription" (RT) evaluations, particularly for scoring **speaker diarization** (the task of identifying "who spoke when").

As a format specified by a U.S. government agency for research, RTTM is in the **public domain**, is not encumbered by patents, and can be freely implemented in any tool.

## 2. Format Overview

At its core, RTTM is a simple, space-delimited text format.

* **File Encoding:** UTF-8.
* **Structure:** Each valid, non-comment line represents a single time-based event.
* **Fields:** Every event line **must** contain exactly **10 fields**, separated by one or more spaces or tabs. Multiple spaces between fields are fine.
* **Null Values:** Fields that are not applicable or have no value *must* use the literal string `<NA>`.
* **Identifiers:** File IDs, speaker IDs, and similar tokens are restricted to ASCII letters, digits, underscore, hyphen, and (optionally) dots. They must not contain spaces.

## 3. Field-by-Field Specification

This table details all 10 mandatory fields in the order they must appear.

| # | Field Name | Description | Example Values |
| :--- | :--- | :--- | :--- |
| 1 | `Type` | The type of event. This dictates the meaning of other fields. | `SPEAKER`, `NON_SPEECH`, `LEXEME` |
| 2 | `File ID` | The file identifier (e.g., basename) of the media being annotated. | `my_recording`, `file_001` |
| 3 | `Channel` | The audio channel (1-indexed) on which the event occurs. | `1`, `2`, `<NA>` (if not applicable) |
| 4 | `Onset` | The **start time** of the event, in seconds, from the beginning of the file. | `0.45`, `123.0`, `98.125` |
| 5 | `Duration` | The **duration** of the event, in seconds. | `1.25`, `0.8`, `10.0` |
| 6 | `Orthography` | The textual transcription of the event. | `<NA>`, `hello`, `music`, `cough` |
| 7 | `Speaker Type / Subset` | The speaker type or subset (e.g., gender or channel class). | `<NA>`, `ADULT`, `CHILD`, `MALE` |
| 8 | `Speaker ID` | The identifier for the speaker or event. | `spk_0`, `speaker_1`, `background_noise` |
| 9 | `Confidence` | The system's confidence score (typically 0.0-1.0). | `<NA>`, `0.98`, `0.45` |
| 10 | `SLAT` | Signal Lookahead Time (legacy field from NIST evaluations). | `<NA>` (almost universally) |

---

## 4. Common "Dialects" & Use Cases

The meaning of the fields (especially `Orthography` and `Speaker ID`) changes based on the `Type` (Field 1). This creates three common "dialects" for RTTM.

### 4.1. Speaker Diarization (The most common use)

This is the classic RTTM use case: marking speech segments for different speakers.

* `Type` is **`SPEAKER`**.
* `Orthography` (Field 6) is almost always **`<NA>`**, as the content of the speech is not the focus.
* `Speaker ID` (Field 8) is the **key information**, identifying the speaker.

**Example:**
```rttm
SPEAKER file_01 1 10.34 2.15 <NA> <NA> spk_0 <NA> <NA>
SPEAKER file_01 1 12.80 0.90 <NA> <NA> spk_1 <NA> <NA>
```

### 4.2. Non-Speech Events

This dialect is used to mark non-linguistic events like music, noise, or silence.

* `Type` is **`NON_SPEECH`**.
* `Orthography` (Field 6) can be `<NA>` or a description (e.g., `music`).
* `Speaker ID` (Field 8) often becomes the event-type identifier.

**Example:**
```rttm
NON_SPEECH file_01 1 14.00 5.0 <NA> <NA> music <NA> <NA>
NON_SPEECH file_01 1 19.00 0.5 <NA> <NA> silence <NA> <NA>
```

### 4.3. Lexical Transcription (ASR Output)

This dialect is used to mark the time of individual words, as generated by an Automatic Speech Recognition (ASR) system.

* `Type` is **`LEXEME`**.
* `Orthography` (Field 6) is the **key information**, containing the transcribed word.
* `Speaker ID` (Field 8) identifies the speaker of that word.
* `Confidence` (Field 9) is often used here.

**Example:**
```rttm
LEXEME file_01 1 10.34 0.25 hello <NA> spk_0 0.98 <NA>
LEXEME file_01 1 10.60 0.30 world <NA> spk_0 0.95 <NA>
```


---

## 5. Validation Checklist

When producing or reviewing RTTM files, verify the following:

1. **Exactly 10 tokens** (separated by whitespace) appear on every non-comment, non-blank line.
2. **Numeric fields** (`Onset`, `Duration`, `Confidence`) use a dot (`.`) as the decimal separator and can omit the fractional part (`15` is valid for `15.0`).
3. **Identifiers contain no spaces** and only `[A-Za-z0-9._-]`. Convert any other characters (e.g., spaces) to underscores before exporting.
4. **`<NA>` is uppercase** and never quoted. Any other representation (`NA`, `None`, `null`) is invalid.
5. **Comments** always begin with `;;`. If you need to annotate an entry inline, append `;; note...` after the tenth field.

Following this checklist keeps the files compatible with both the original NIST scoring tools and modern parsers such as this Tree-sitter grammar.

## 6. Comments

RTTM files can contain comments.

* Any line beginning with two semicolons (`;;`) is considered a comment and must be ignored by parsers.
* Inline comments are permitted: a comment that follows a valid event on the same line is treated as a separate comment line. This is common when annotators tack on notes at the end of an entry.
* Comments may be indented, may appear between blank lines, and can contain arbitrary text.

**Example:**
```rttm
;; This is a file-level comment.
SPEAKER file_01 1 10.34 2.15 <NA> <NA> spk_0 <NA> <NA> ;; raw diarization output
    ;; Processed by NIST-Tool v5 on 2025-11-13
```
